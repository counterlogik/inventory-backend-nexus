# Migration `20200419161203-add-enum-spark`

This migration has been generated by addison staples at 4/19/2020, 4:12:03 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TYPE "Spark" AS ENUM ('lose', 'like', 'love', 'need');

CREATE TABLE "public"."_ItemToLocation" (
    "A" integer  NOT NULL ,
    "B" integer  NOT NULL 
) 

ALTER TABLE "public"."Item" DROP CONSTRAINT IF EXiSTS "Item_locationId_fkey",
DROP COLUMN "locationId",
DROP COLUMN "spark",
ADD COLUMN "spark" "Spark"  DEFAULT 'like';

CREATE UNIQUE INDEX "_ItemToLocation_AB_unique" ON "public"."_ItemToLocation"("A","B")

CREATE  INDEX "_ItemToLocation_B_index" ON "public"."_ItemToLocation"("B")

ALTER TABLE "public"."_ItemToLocation" ADD FOREIGN KEY ("A")REFERENCES "public"."Item"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_ItemToLocation" ADD FOREIGN KEY ("B")REFERENCES "public"."Location"("id") ON DELETE CASCADE  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200419144049-remove-field-handle-from-model-user-and-add-unique-multifield-attribute-to-models-category--location--tag..20200419161203-add-enum-spark
--- datamodel.dml
+++ datamodel.dml
@@ -1,13 +1,20 @@
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("DATABASE_URL")
 }
 generator prisma_client {
   provider = "prisma-client-js"
 }
+enum Spark {
+  lose
+  like
+  love
+  need
+}
+
 model User {
   id         Int        @default(autoincrement()) @id
   createdAt  DateTime   @default(now())
   updatedAt  DateTime   @updatedAt
@@ -29,11 +36,10 @@
   updatedAt     DateTime   @updatedAt
   description   String
   model         String?
   categories    Category[] @relation(references: [id])
-  location      Location?  @relation(fields: [locationId], references: [id])
-  locationId    Int?
-  spark         Int?
+  locations     Location[] @relation(references: [id])
+  spark         Spark?     @default(like)
   count         Int        @default(1)
   monetaryValue Float?
   link          String?
   notes         String?
@@ -61,9 +67,9 @@
   createdAt   DateTime @default(now())
   title       String
   description String?
   image       String?
-  items       Item[]
+  items       Item[]   @relation(references: [id])
   @@unique([ownerId, title])
 }
```


