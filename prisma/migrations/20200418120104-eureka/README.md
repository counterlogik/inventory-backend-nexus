# Migration `20200418120104-eureka`

This migration has been generated by addison staples at 4/18/2020, 12:01:04 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."_CategoryToItem" (
    "A" integer  NOT NULL ,
    "B" integer  NOT NULL 
) 

ALTER TABLE "public"."Item" DROP CONSTRAINT IF EXiSTS "Item_categoryId_fkey",
DROP COLUMN "categoryId";

CREATE UNIQUE INDEX "_CategoryToItem_AB_unique" ON "public"."_CategoryToItem"("A","B")

CREATE  INDEX "_CategoryToItem_B_index" ON "public"."_CategoryToItem"("B")

ALTER TABLE "public"."_CategoryToItem" ADD FOREIGN KEY ("A")REFERENCES "public"."Category"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_CategoryToItem" ADD FOREIGN KEY ("B")REFERENCES "public"."Item"("id") ON DELETE CASCADE  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200418115101-clean-up..20200418120104-eureka
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("DATABASE_URL")
 }
 generator prisma_client {
   provider = "prisma-client-js"
@@ -20,25 +20,24 @@
   world   World  @relation(fields: [worldId], references: [id])
 }
 model Item {
-  id            Int      @default(autoincrement()) @id
-  owner         User     @relation(fields: [ownerId], references: [id])
+  id            Int        @default(autoincrement()) @id
+  owner         User       @relation(fields: [ownerId], references: [id])
   ownerId       Int
-  createdAt     DateTime @default(now())
-  updatedAt     DateTime @updatedAt
+  createdAt     DateTime   @default(now())
+  updatedAt     DateTime   @updatedAt
   description   String
   model         String?
-  category      Category @relation(fields: [categoryId], references: [id])
-  categoryId    Int
-  location      Location @relation(fields: [locationId], references: [id])
+  categories    Category[] @relation(references: [id])
+  location      Location   @relation(fields: [locationId], references: [id])
   locationId    Int
   spark         Int?
-  count         Int      @default(1)
+  count         Int        @default(1)
   monetaryValue Float
   link          String
   notes         String
-  tags          Tag[]    @relation(references: [id])
+  tags          Tag[]      @relation(references: [id])
   image         String
 }
 model Category {
@@ -48,8 +47,9 @@
   createdAt   DateTime @default(now())
   title       String
   description String?
   image       String?
+  items       Item[]   @relation(references: [id])
   @@unique([ownerId, title])
 }
```


